<html>
<!--HEAD-->
<%- include("../partials/headDetallePelicula") %>

  <body class="bg1">
    <%- include("../partials/header") %>

      <!--MAIN-->
      <main>

        <div class="contenedorPrincipal">
          <div class="videodeyoutube">
            <iframe width="1000" height="550" src="<%= movie.video %>" title="YouTube video player" frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowfullscreen></iframe>
          </div>

          <div class="card mb-3 fondo" style="max-width: 1000px;">


            <div class="card-body espaciado">

              <h3 class="card-title titulo">
                <%=movie.nombre%>
              </h3>

              <p class="linea">
                <%= movie.resumen%>
              </p>


              <% if (movie.genero) { %>
                <h6 class="card-title linea">Género:
                  <%= movie.genero.nombre %>
                </h6>
                <% } else { %>
                  <p class="card-title linea">Género: No especificado</p>
                  <% } %>


                    <h6 class="card-title linea"> Duración:
                      <%=movie.duracion%>min
                    </h6>

                    <h6 class="card-title linea">Fecha de estreno:
                      <%=movie.fecha_estreno%>
                    </h6>



                    <!-- CALIFICACION-->
                    <% if (locals.isLogged) {%>
                      <form action="/peliculas/detalle/<%= movie.id %>" method="POST" class="calificacion-form">
                        <input type="hidden" name="usuarioId" value="<%=locals.userLogged.id %>" />
                        <div class="calificacion">
                          <h6 class="card-title linea" for="calificacion">Calificación:</h6>
                          <div class="clasificacion">
                            <input id="radio5" type="radio" name="calificacion" value="5" />
                            <label for="radio5">★</label>
                            <input id="radio4" type="radio" name="calificacion" value="4" />
                            <label for="radio4">★</label>
                            <input id="radio3" type="radio" name="calificacion" value="3" />
                            <label for="radio3">★</label>
                            <input id="radio2" type="radio" name="calificacion" value="2" />
                            <label for="radio2">★</label>
                            <input id="radio1" type="radio" name="calificacion" value="1" />
                            <label for="radio1">★</label>
                          </div>
                        </div>
                        <button class="cFondo boton-enviar" type="submit">Enviar</button>
                      </form>
                      <% } else {%>
                        <a class="validacion" href="/usuarios/login">
                          <span></span>
                          <span></span>
                          <span></span>
                          <span></span>
                          Logueate para calificar
                        </a>
                        <% }%>
                          <!--FINAL CALIFICACION-->


                          <div style="display: flex; gap: 20px;">
                            <a href="/peliculas/actualizarFilm/<%= movie.id %>"
                              class="btn btn-primary altura">Actualizar</a>

                            <form id="eliminar" action="/peliculas/delete/<%= movie.id %>?_method=DELETE" method="POST">
                              <button type="submit" class="btn btn-primary br altura">Eliminar</button>
                            </form>

                          </div>
            </div>
          </div>
        </div>
        </div>
        </form>


        <script src="/js/deleteFilm.js"></script>


        <script>
          // Agrega un evento 'click' al botón "Enviar"
          document.querySelector('.boton-enviar').addEventListener('click', function (event) {
            // Evita el comportamiento predeterminado del botón
            event.preventDefault();

            // Muestra un mensaje de agradecimiento usando SweetAlert2 con animación personalizada
            Swal.fire({
              title: '¡Gracias por tu voto cinefilo!',
              text: 'Tu opinión es muy valiosa para nosotros.',
              icon: 'success',
              confirmButtonText: 'Aceptar',
              showClass: {
                popup: 'animate__animated animate__fadeInDown'
              },
              hideClass: {
                popup: 'animate__animated animate__fadeOutUp'
              }
            });
          });
        </script>


        </div>
        </div>
        </div>
        </div>
        </div>
      </main>
      <!--FOOTER-->
      <%- include("../partials/footer") %>
  </body>

</html>